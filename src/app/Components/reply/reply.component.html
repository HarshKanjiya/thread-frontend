<div class="flex gap-2">
  <div class="w-4 sm:w-16 h-full"></div>

  <div
    [routerLink]="['/thread/' + ThreadData?.ThreadId]"
    class="flex gap-3 w-full py-4 cursor-pointer {{
      ThreadData?.Type !== 'REPOST'
        ? 'border-t-[1px] border-neutral-400 dark:border-neutral-700'
        : ''
    }} "
  >
    <div class="flex flex-col justify-between gap-2 items-center min-h-max">
      <img
        class="h-8 w-8 rounded-full"
        src="{{
          UserData?.AvatarURL
            ? UserData?.AvatarURL
            : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAACUCAMAAAA02EJtAAAAMFBMVEXk5ueutLfn6eqqsLTM0NLq7O26v8KnrrHf4eLHy82xt7rS1dfY29zU2Nnb3t/DyMryEXPkAAAD7klEQVR4nO2c2XLkIAwAQdz4+v+/XRg7GydxPICwoCr0U3bz0iULcYkwNhgMBoPBYDAYDAaDwaArlAJm54B9/dgtwGanPT/wWlro0RbYOmlh+Jnwz21hndmCmjcv+E+E0M6q1nonwOoLzf+4bvIA7GbuTLngUx9pAMvlp/8qq20Hrmp75/nCz81drX4b0h0jm5umiUZX1zSukCwaEC1drX8veI7r1s41/esfrrKRq9oSR9SJNnUApvvCf4lfW5iu+aJxLmgR1txE3TELuSvI/ETdseSqhaJcUFes8qDSj6xS0RhWUlFEUIMrqSpLXU9dQTtnzeWiAU+oCg4RVE46vULeiuoHjm4Pawtm/zOazBQ1/iN+plJVZdP/J4JsIaCQplyQbQktWpVswsJV1QjVuIIJreqpVCValVOpOrSpIFpfQ9op1R1mqP5tVbJcxVcAqo0AerXCyYoVW9CmZKtA/BqATBWwCSAclapC7le4mKjWq+iZlW4XwFbs3orwiA0ZVcITNig4Wj9Deca64FTpRLNvgb4iNOWtO+okiGpZdagW3Vkc0J2tvECcWoiFVpWx4tJKHFRMvaK/ECwsArTDf6f04KLFbWBZCpCPqZ0C01bdC9nFtc1lcAQyN1mC6lTtyjWvJcCT3wSfUBlloHVbGCzJ5VW3brYD+77NLmJoL4F/IekIi2yPeot637/YRfdiBKwTN7LGN5qiLoHfs0D4qbXdNxST2n+Lbfin35ZuWoI/iY3hmxbGiJelMVy7pc8edsZehdMuUjonp9ke/9EpEFA78ccuTeF4ZjFNMaYBKeW0zOv+i24I0YtZ6i+nWK83OXeQCADWLk7zfSj9Wq7Cr8MIW9sNMVA2xvKu+H8pXCG+UxNbYFPJqUV8gkOqCXbSt9/8Jrom2FLlLrDl+mlNKsZvJA9FACbspUXEy6dlwcrEYfQOIdyTWRuWJB55YXGW9c/JKlnj05/x8pniNet6Ef1APHCDcbN2RspulbMgYftUjJcVjzFDSOt/+09MvU0irJh25QSEr5SxKv0ApZwqSQDuyY//QZVmBuR1aoYrMgng4TQ9uyKng+dq1E88qhCQxTSCOYCt0KaW6Vqqim1QKKCwDoCkqFLfKLosAnxHdQFFbU2JB+fVXfNvYRTp4D+Rna6AbKRBkPsaC9VHgyQvBbAPqjDkdgw0E+WxYygjBUoeflcka9JqUPzPpG8KVMNMjeQ8HGo4/HdSi0CFlz9I0l+6th1UEZ9Yr1qW/wOTGNS5eVC5SMyACo8p0KTNWOinnzVI6x1Sjev/i7S/dwBdqCZNWNim/zokjavJiPak/ZmmVfZA2tMR6IIk1cEf4h/bxDWtKov23AAAAABJRU5ErkJggg=='
        }}"
      />
      <div
        class="w-[2.5px] rounded-md h-max flex-1 content-[' '] bg-neutral-300 dark:bg-neutral-800"
      ></div>

      <img class="h-4 w-4 rounded-full" [src]="UserData?.AvatarURL" />
    </div>

    <div class="flex flex-col flex-1 gap-3">
      <!-- time and more -->

      <div class="flex justify-between items-center">
        <p class="font-semibold">{{ UserData?.UserName }}</p>

        <div class="flex gap-3 items-center">
          <p class="text-sm text-neutral-400 dark:text-neutral-500">
            {{ timeDifference(ThreadData.CreatedAt) }}
          </p>

          <div #menu>
            <div class="relative" (click)="stopPropagation($event)">
              <button
                type="button"
                (click)="setIsOpen()"
                class="h-6 w-6 rounded-full"
              >
                <div class="">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="fill-neutral-700 dark:fill-neutral-300"
                  >
                    <circle cx="12" cy="12" r="1.5" />
                    <circle cx="18" cy="12" r="1.5" />
                    <circle cx="6" cy="12" r="1.5" />
                  </svg>
                </div>
              </button>

              @if (isOpen) {
              <div
                @dropBody
                class="absolute z-10 top-[100%] right-[10%] w-min min-w-[100px] flex flex-col justify-between overflow-hidden bg-white dark:bg-black rounded-2xl border border-neutral-300 dark:border-neutral-800"
              >
                <button
                  type="button"
                  class="editBtn relative cursor-pointer hover:bg-neutral-100 dark:hover:bg-neutral-900 px-4 py-2 w-full flex justify-start items-center gap-3 text-sm pt-3 after:hover:bg-black dark:after:bg-white"
                  (click)="menuClickHandler('edit')"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="h-4 w-4 stroke-black dark:stroke-white"
                  >
                    <path
                      d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"
                    />
                    <path d="m15 5 4 4" />
                  </svg>

                  <span>Edit</span>
                </button>
                <hr class="w-full border-neutral-300 dark:border-neutral-700" />
                <button
                  type="button"
                  class="cursor-pointer hover:bg-neutral-100 dark:hover:bg-neutral-900 px-4 py-2 w-full flex justify-start items-center gap-3 text-sm pt-3"
                  (click)="menuClickHandler('delete')"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="h-4 w-4 stroke-black dark:stroke-white"
                  >
                    <path d="M3 6h18" />
                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                  </svg>
                  <span>Delete</span>
                </button>
                <hr class="w-full border-neutral-300 dark:border-neutral-700" />
                <button
                  type="button"
                  class="cursor-pointer hover:bg-neutral-100 dark:hover:bg-neutral-900 px-4 py-2 w-full flex justify-start items-center gap-3 text-sm pt-3"
                  (click)="menuClickHandler('report')"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="h-4 w-4 stroke-red-500"
                  >
                    <path
                      d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                    />
                    <path d="M12 7v2" />
                    <path d="M12 13h.01" />
                  </svg>
                  <span class="text-red-500">Report</span>
                </button>
              </div>
              }
            </div>
          </div>
        </div>
      </div>

      <!-- thread body -->

      <p class="text-sm">
        {{ ThreadData?.Content?.Text }}
      </p>

      <div class="rounded-xl w-full h-min" (click)="stopPropagation($event)">
        <!-- <img
        class="w-full h-full"
        src="https://imgs.search.brave.com/2b-Uo-puBDxcXx5DLraCYgOyptGt7vj1ecgCIQw8-Ms/rs:fit:860:0:0/g:ce/aHR0cHM6Ly90My5m/dGNkbi5uZXQvanBn/LzAzLzQ1LzA1Lzky/LzM2MF9GXzM0NTA1/OTIzMl9DUGllVDhS/SVdPVWs0SnFCa2tX/a0lFVFlBa216MmI3/NS5qcGc"
      /> -->

        @if(ThreadData?.Content?.ContentType ==="TEXT"){
        <app-carousel [slides]="ThreadData?.Content?.Files"></app-carousel>

        }@else {
        <div class="w-full flex flex-col gap-2">
          @for (item of ThreadData?.Content?.Options; track $index) {
          <button
            (click)="choseOption(item, $index)"
            class="rounded-lg relative outline -outline-offset-2 outline-[1.5px] outline-neutral-400 dark:outline-neutral-800 overflow-hidden flex items-center justify-between"
          >
            <!-- class="absolute contents-[' '] h-full left-0 bg-neutral-400 dark:bg-neutral-800 w-full origin-left -z-1 opacity-50 scale-x-[{{0.66}}] " -->
            <div
              [style.width]="
                getWidth(
                  demoRatings.TotalResponse,
                  demoRatings.Responses[$index]
                ) + '%'
              "
              class="absolute contents-[' '] h-full left-0 bg-neutral-400 dark:bg-neutral-800 origin-left -z-1 opacity-50 transition-all duration-150 ease-in"
            ></div>
            <!-- (click)="" -->
            <div class="p-3 flex gap-3 items-center">
              <div
                class="group relative flex items-center justify-center rounded-full border border-neutral-400 dark:border-neutral-700 h-5 w-5 {{
                  item.OptionId === selectedPollOption?.OptionId
                    ? 'bg-black dark:bg-white'
                    : 'bg-white dark:bg-black'
                }}"
              >
                <div
                  class="h-1.5 w-1.5 rounded-full  contents-[' '] group {{
                    item.OptionId === selectedPollOption?.OptionId
                      ? 'bg-white dark:bg-black'
                      : 'w-0 h-0'
                  }}"
                ></div>
              </div>
              <p>{{ item?.Value }}</p>
            </div>
            <p class="p-3">{{ demoRatings.Responses[$index] }}</p>
          </button>
          }
        </div>
        }
      </div>

      <div class="flex py-1 gap-2">
        <div
          class="w-7 h-7 p-1 transition-all duration-150 flex items-center justify-center overflow-hidden rounded-lg"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            version="1.1"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            width="512"
            height="512"
            x="0"
            y="0"
            viewBox="0 0 512 512"
            style="enable-background: new 0 0 512 512"
            xml:space="preserve"
            class="fill-black dark:fill-white stroke-black dark:stroke-white"
          >
            <g>
              <path
                d="M256 455.516c-7.29 0-14.316-2.641-19.793-7.438-20.684-18.086-40.625-35.082-58.219-50.074l-.09-.078c-51.582-43.957-96.125-81.918-127.117-119.313C16.137 236.81 0 197.172 0 153.871c0-42.07 14.426-80.883 40.617-109.293C67.121 15.832 103.488 0 143.031 0c29.555 0 56.621 9.344 80.446 27.77C235.5 37.07 246.398 48.453 256 61.73c9.605-13.277 20.5-24.66 32.527-33.96C312.352 9.344 339.418 0 368.973 0c39.539 0 75.91 15.832 102.414 44.578C497.578 72.988 512 111.801 512 153.871c0 43.3-16.133 82.938-50.777 124.738-30.993 37.399-75.532 75.356-127.106 119.309-17.625 15.016-37.597 32.039-58.328 50.168a30.046 30.046 0 0 1-19.789 7.43zM143.031 29.992c-31.066 0-59.605 12.399-80.367 34.914-21.07 22.856-32.676 54.45-32.676 88.965 0 36.418 13.535 68.988 43.883 105.606 29.332 35.394 72.961 72.574 123.477 115.625l.093.078c17.66 15.05 37.68 32.113 58.516 50.332 20.961-18.254 41.012-35.344 58.707-50.418 50.512-43.051 94.137-80.223 123.469-115.617 30.344-36.618 43.879-69.188 43.879-105.606 0-34.516-11.606-66.11-32.676-88.965-20.758-22.515-49.3-34.914-80.363-34.914-22.758 0-43.653 7.235-62.102 21.5-16.441 12.719-27.894 28.797-34.61 40.047-3.452 5.785-9.53 9.238-16.261 9.238s-12.809-3.453-16.262-9.238c-6.71-11.25-18.164-27.328-34.61-40.047-18.448-14.265-39.343-21.5-62.097-21.5zm0 0"
                opacity="1"
              ></path>
            </g>
          </svg>
        </div>
        <div
          class="w-6 h-6 transition-all duration-150 flex items-center justify-center overflow-hidden rounded-lg"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="fill-white dark:fill-black stroke-black dark:stroke-white transform scale-x-[-1]"
          >
            <path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z" />
          </svg>
        </div>
        <div
          class="w-6 h-6 transition-all duration-150 flex items-center justify-center overflow-hidden rounded-lg"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            version="1.1"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            width="512"
            height="512"
            x="0"
            y="0"
            viewBox="0 0 24 24"
            stroke-width="1"
            stroke-linecap="round"
            stroke-linejoin="round"
            xml:space="preserve"
            class="fill-black dark:fill-white"
          >
            <g
              transform="matrix(6.123233995736767e-17,-1.0000000000000002,1.0000000000000002,6.123233995736767e-17,-0.5000102519989014,24.499989748001113)"
            >
              <path
                fill-rule="evenodd"
                d="M1.293 9.793a1 1 0 0 0 1.414 1.414L4 9.914V15.5a3 3 0 0 0 3 3h5a1 1 0 1 0 0-2H7a1 1 0 0 1-1-1V9.914l1.293 1.293a1 1 0 0 0 1.414-1.414l-3-3a1 1 0 0 0-1.414 0zm21.414 5.414a1 1 0 0 0-1.414-1.414L20 15.086V9.5a3 3 0 0 0-3-3h-5a1 1 0 1 0 0 2h5a1 1 0 0 1 1 1v5.586l-1.293-1.293a1 1 0 0 0-1.414 1.414l3 3a1 1 0 0 0 1.414 0z"
                clip-rule="evenodd"
                opacity="1"
              ></path>
            </g>
          </svg>
        </div>
        <div
          class="w-6 h-6 p-0.5 transition-all duration-150 flex items-center justify-center overflow-hidden rounded-lg"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-send"
          >
            <path d="m22 2-7 20-4-9-9-4Z" />
            <path d="M22 2 11 13" />
          </svg>
        </div>
      </div>

      <div
        class="flex gap-3 items-center text-sm font-light text-neutral-400 dark:text-neutral-500"
      >
        <p>{{ ThreadData.Replies }} replies</p>
        <div
          class="w-[3px] h-[3px] rounded-full bg-neutral-400 dark:bg-neutral-500"
        ></div>
        <p>{{ ThreadData.Likes }} likes</p>
      </div>
    </div>
  </div>
</div>
